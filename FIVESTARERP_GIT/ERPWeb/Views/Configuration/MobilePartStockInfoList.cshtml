@model IEnumerable<ERPBO.Configuration.ViewModels.MobilePartStockInfoViewModel>
@{
    ViewBag.Title = "MobilePartStockInfoList";
}

<div class="row">
    <div class="col-md-12 text-center">
        <div class="row">
            <div class="col-md-3">
                <a href="/Configuration/MobilePartStockDetailList" class="float-left btn btn-sm btn-outline-primary" title="Details View">
                    <i class="fas fa-eye"></i> Go To Details View
                </a>
            </div>
            <div class="col-md-6">
                <h4><b style="color:darkblue">Mobile Parts Stock List</b></h4>
            </div>
            <div class="col-md-3">
                <a href="/Configuration/CreateMobilePartStock" class="btn btn-outline-success btn-sm float-lg-right" id="btnAddNew"><i class="fa fa-plus"></i> MobilePart Stock-In</a>
            </div>
        </div>
        <hr />
    </div>
    <div class="col-md-12 mb-2">
        @Html.AntiForgeryToken()
        <h5 class="text-cyan"><b>Search By</b></h5>
        <div class="row">
            <div class="col-md-3">
                <label for="ddlServicesWarehouse" class="control-label font-weight-bold">ServicesWarehouse Name</label>
                @Html.DropDownList("ddlServicesWarehouse", (IEnumerable<SelectListItem>)ViewBag.ddlServicesWarehouse, "--Select MobilePart--", new { @class = "form-control form-control-sm" })
            </div>
            <div class="col-md-3">
                <label for="ddlMobilePart" class="control-label font-weight-bold">MobilePart Name</label>
                @Html.DropDownList("ddlMobilePart", (IEnumerable<SelectListItem>)ViewBag.ddlMobilePart, "--Select MobilePart--", new { @class = "form-control form-control-sm" })
            </div>
            <div class="col-md-3">
                <label for="txtLessOrEq" class="control-label font-weight-bold">Stock Qty (Less then / Equal)</label>
                <input type="number" id="txtLessOrEq" class="form-control form-control-sm" />
            </div>
        </div>
    </div>
    <div class="col-md-12" id="dataContainer">
        @{Html.RenderAction("MobilePartStockInfoPartialList");}
    </div>
</div>

@section scripts{
    <script type="text/javascript">
        var ddlServicesWarehouse = $("#ddlServicesWarehouse");
        var ddlMobilePart = $("#ddlMobilePart");
        var txtLessOrEq = $("#txtLessOrEq");
        var pageNo = 1;

        ddlServicesWarehouse.change(function () {
            LoadDataTable();
        })
        ddlMobilePart.change(function () {
            LoadDataTable();
        })
        txtLessOrEq.keyup(function () {
            LoadDataTable();
        })


        function LoadDataTable() {
            var data = { flag: "search", SwerehouseId: TryParseInt(ddlServicesWarehouse.val(), 0), MobilePartId: TryParseInt(ddlMobilePart.val(), 0), lessOrEq: txtLessOrEq.val() };

            console.log(data);
            $.when(getReqWithData('html', 'GET', '/Configuration/MobilePartStockInfoPartialList', data)).then(function (res, status) {
                console.log(status);
                if (status === "success") {
                    $("#dataContainer").fadeOut('500', function () {
                        $("#dataContainer").empty();
                        $("#dataContainer").append(res).fadeIn('500');
                    });
                }
            }).fail(function (error) {
                console.log(error);
            })
            pageNo = 1;
        }
    </script>
    }